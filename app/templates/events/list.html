{% extends "layout.html" %}
{% block content %}

<h2>Events</h2>

<form method="post"
      action="{% if edit_event %}
                  {{ url_for('events.update_event', event_id=edit_event.id) }}
              {% else %}
                  {{ url_for('events.create_event') }}
              {% endif %}"
      class="card">

    <label>Title</label>
    <input type="text" name="title"
           value="{{ edit_event.title if edit_event else '' }}"
           required>

    <label>Start Time</label>
    <input type="datetime-local" name="start_time"
           value="{{ edit_event.start_time.strftime('%Y-%m-%dT%H:%M') if edit_event else '' }}"
           required>

    <label>End Time</label>
    <input type="datetime-local" name="end_time"
           value="{{ edit_event.end_time.strftime('%Y-%m-%dT%H:%M') if edit_event else '' }}"
           required>

    <br><br>
    <button type="submit">
        {{ 'Update Event' if edit_event else 'Add Event' }}
    </button>

    {% if edit_event %}
        <a href="{{ url_for('events.list_events') }}" class="Cancel">Cancel</a>
    {% endif %}
</form>

<hr>

<table border="1" cellpadding="8" width="100%">
    <tr>
        <th>Title</th>
        <th>Start</th>
        <th>End</th>
        <th>Actions</th>
    </tr>

    {% for event in events %}
    <tr>
        <td>{{ event.title }}</td>
        <td>{{ event.start_time }}</td>
        <td>{{ event.end_time }}</td>
        <td>
            <a href="{{ url_for('events.list_events', edit=event.id) }}" class="edit-btn">
                Edit
            </a>

            <!-- ðŸ”´ ONLY FIX: type="button" -->
            <button type="button"
                    class="btn-delete"
                    data-delete-url="{{ url_for('events.delete_event', event_id=event.id) }}"
                    onclick="openConfirmModal(this.dataset.deleteUrl)">
                Delete
            </button>
        </td>
    </tr>
    {% else %}
    <tr>
        <td colspan="4">No events found</td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
